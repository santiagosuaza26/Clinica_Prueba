<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinic IPS - M√©dico</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Clinic IPS - Panel M√©dico</h1>
            <p>Bienvenido, <span id="username"></span></p>
            <button class="logout-btn" onclick="logout()">Cerrar Sesi√≥n</button>
        </header>
        <div class="tab">
             <button class="tablinks active" onclick="openTab(event, 'patients')">
                 <i class="fas fa-users"></i>
                 Buscar Paciente
             </button>
             <button class="tablinks" onclick="openTab(event, 'history')">
                 <i class="fas fa-file-medical"></i>
                 üìã Historia Cl√≠nica
             </button>
             <button class="tablinks" onclick="openTab(event, 'medications')">
                 <i class="fas fa-pills"></i>
                 üíä Medicamentos
             </button>
             <button class="tablinks" onclick="openTab(event, 'procedures')">
                 <i class="fas fa-user-md"></i>
                 üß´ Procedimientos
             </button>
             <button class="tablinks" onclick="openTab(event, 'diagnostic-aids')">
                 <i class="fas fa-flask"></i>
                 üß™ Ayudas Diagn√≥sticas
             </button>
             <button class="tablinks" onclick="openTab(event, 'hospitalization')">
                 <i class="fas fa-bed"></i>
                 üè• Hospitalizaci√≥n
             </button>
         </div>

        <div id="appointments" class="tabcontent" style="display: block;">
            <h2><i class="fas fa-calendar-check" style="margin-right: 0.5rem; color: var(--primary-color);"></i>Mis Citas M√©dicas</h2>
            <button class="accordion">
                <i class="fas fa-eye"></i>
                Ver Citas Programadas
            </button>
            <div class="panel">
                <div style="margin-bottom: 1rem;">
                    <button class="btn-secondary" onclick="loadAppointments()">
                        <i class="fas fa-sync-alt"></i>
                        Actualizar Lista
                    </button>
                    <span class="status-badge status-active" style="margin-left: 1rem;">
                        <i class="fas fa-circle"></i>
                        Citas de Hoy
                    </span>
                </div>
                <div id="appointmentsList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>

        <div id="patients" class="tabcontent" style="display: block;">
            <h2><i class="fas fa-users" style="margin-right: 0.5rem; color: var(--primary-color);"></i>Buscar Paciente</h2>
            <div class="search-container">
                <input type="text"
                       id="patientSearch"
                       placeholder="Buscar por c√©dula..."
                       style="flex: 1; min-width: 250px;">
                <button class="btn-secondary" onclick="searchPatient()">
                    <i class="fas fa-search"></i>
                    Buscar Paciente
                </button>
            </div>
            <div id="patientInfo" class="patient-info" style="display: none;"></div>
            <div id="patientsList" style="max-height: 400px; overflow-y: auto; margin-top: 1rem;"></div>
        </div>

        <div id="history" class="tabcontent">
            <h2><i class="fas fa-file-medical" style="margin-right: 0.5rem; color: var(--primary-color);"></i>üìã Historia Cl√≠nica</h2>
            <div class="search-container">
                <input type="text"
                       id="historyPatientSearch"
                       placeholder="Buscar paciente por c√©dula..."
                       style="flex: 1; min-width: 250px;">
                <button class="btn-secondary" onclick="searchPatientForHistory()">
                    <i class="fas fa-search"></i>
                    Buscar
                </button>
            </div>
            <div id="historyPatientInfo" class="patient-info" style="display: none;"></div>

            <button class="accordion">
                <i class="fas fa-plus"></i>
                Registrar Nueva Consulta
            </button>
            <div class="panel">
                <form id="createHistoryForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="historyPatientCedula">
                                <i class="fas fa-id-card" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                C√©dula del Paciente:
                            </label>
                            <input type="text"
                                   id="historyPatientCedula"
                                   placeholder="N√∫mero de c√©dula del paciente"
                                   pattern="[0-9]+"
                                   title="Solo n√∫meros"
                                   required
                                   readonly>
                        </div>
                        <div class="form-group">
                            <label for="appointmentDate">
                                <i class="fas fa-calendar" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                Fecha de Consulta:
                            </label>
                            <input type="datetime-local"
                                   id="appointmentDate"
                                   required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="reasonForConsultation">
                            <i class="fas fa-question-circle" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Motivo de Consulta:
                        </label>
                        <textarea id="reasonForConsultation"
                                  placeholder="Describa el motivo principal de la consulta..."
                                  rows="3"
                                  required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="symptoms">
                            <i class="fas fa-thermometer-half" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Sintomatolog√≠a:
                        </label>
                        <textarea id="symptoms"
                                  placeholder="Describa los s√≠ntomas presentados por el paciente..."
                                  rows="4"
                                  required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="diagnosis">
                            <i class="fas fa-stethoscope" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Diagn√≥stico:
                        </label>
                        <textarea id="diagnosis"
                                  placeholder="Registre el diagn√≥stico m√©dico..."
                                  rows="4"
                                  required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="treatment">
                            <i class="fas fa-prescription-bottle-alt" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Tratamiento y Observaciones:
                        </label>
                        <textarea id="treatment"
                                  placeholder="Describa el tratamiento prescrito y observaciones adicionales..."
                                  rows="4"
                                  required></textarea>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i>
                            üíæ Guardar Historia Cl√≠nica
                        </button>
                        <button type="button" class="btn-success" onclick="finishAppointment()" style="margin-left: 1rem;">
                            <i class="fas fa-check-circle"></i>
                            ‚úÖ Finalizar Atenci√≥n
                        </button>
                    </div>
                </form>
            </div>

            <div class="list-section">
                <h3><i class="fas fa-history"></i> Historial de Consultas</h3>
                <div id="historyList"></div>
            </div>
        </div>

        <div id="medications" class="tabcontent">
            <h2><i class="fas fa-pills" style="margin-right: 0.5rem; color: var(--primary-color);"></i>üíä Medicamentos</h2>
            <div class="search-container">
                <input type="text"
                       id="medPatientSearch"
                       placeholder="Buscar paciente por c√©dula..."
                       style="flex: 1; min-width: 250px;">
                <button class="btn-secondary" onclick="searchPatientForMedications()">
                    <i class="fas fa-search"></i>
                    Buscar
                </button>
            </div>
            <div id="medPatientInfo" class="patient-info" style="display: none;"></div>

            <button class="accordion">
                <i class="fas fa-prescription-bottle-alt"></i>
                Crear Orden de Medicamentos
            </button>
            <div class="panel">
                <form id="createMedicationOrderForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="medOrderPatientCedula">
                                <i class="fas fa-id-card" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                C√©dula del Paciente:
                            </label>
                            <input type="text"
                                   id="medOrderPatientCedula"
                                   required
                                   readonly>
                        </div>
                        <div class="form-group">
                            <label for="medicationOrderNumber">
                                <i class="fas fa-hashtag" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                N√∫mero de Orden (6 d√≠gitos):
                            </label>
                            <input type="text"
                                   id="medicationOrderNumber"
                                   pattern="[0-9]{6}"
                                   title="Debe ser un n√∫mero de 6 d√≠gitos"
                                   required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="medicationSelect">
                            <i class="fas fa-pills" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Medicamento:
                        </label>
                        <select id="medicationSelect" required>
                            <option value="">Seleccionar medicamento...</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="medicationDose">
                                <i class="fas fa-syringe" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                Dosis:
                            </label>
                            <input type="text"
                                   id="medicationDose"
                                   placeholder="ej: 500mg, 1 tableta"
                                   required>
                        </div>
                        <div class="form-group">
                            <label for="medicationDuration">
                                <i class="fas fa-clock" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                Duraci√≥n:
                            </label>
                            <input type="text"
                                   id="medicationDuration"
                                   placeholder="ej: 7 d√≠as, 1 mes"
                                   required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="medicationInstructions">
                            <i class="fas fa-info-circle" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Instrucciones:
                        </label>
                        <textarea id="medicationInstructions"
                                  placeholder="Instrucciones de administraci√≥n..."
                                  rows="3"></textarea>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-plus"></i>
                            ‚ûï Agregar a Orden
                        </button>
                        <button type="button" class="btn-success" onclick="createMedicationOrder()" style="margin-left: 1rem;">
                            <i class="fas fa-save"></i>
                            üíæ Crear Orden Completa
                        </button>
                    </div>
                </form>
            </div>

            <div class="list-section">
                <h3><i class="fas fa-list"></i> √ìrdenes de Medicamentos</h3>
                <div id="medicationOrdersList"></div>
            </div>
        </div>

        <div id="procedures" class="tabcontent">
            <h2><i class="fas fa-user-md" style="margin-right: 0.5rem; color: var(--primary-color);"></i>üß´ Procedimientos</h2>
            <div class="search-container">
                <input type="text"
                       id="procPatientSearch"
                       placeholder="Buscar paciente por c√©dula..."
                       style="flex: 1; min-width: 250px;">
                <button class="btn-secondary" onclick="searchPatientForProcedures()">
                    <i class="fas fa-search"></i>
                    Buscar
                </button>
            </div>
            <div id="procPatientInfo" class="patient-info" style="display: none;"></div>

            <button class="accordion">
                <i class="fas fa-stethoscope"></i>
                Crear Orden de Procedimientos
            </button>
            <div class="panel">
                <form id="createProcedureOrderForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="procOrderPatientCedula">
                                <i class="fas fa-id-card" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                C√©dula del Paciente:
                            </label>
                            <input type="text"
                                   id="procOrderPatientCedula"
                                   required
                                   readonly>
                        </div>
                        <div class="form-group">
                            <label for="procedureOrderNumber">
                                <i class="fas fa-hashtag" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                N√∫mero de Orden (6 d√≠gitos):
                            </label>
                            <input type="text"
                                   id="procedureOrderNumber"
                                   pattern="[0-9]{6}"
                                   title="Debe ser un n√∫mero de 6 d√≠gitos"
                                   required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="procedureSelect">
                            <i class="fas fa-user-md" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Procedimiento:
                        </label>
                        <select id="procedureSelect" required>
                            <option value="">Seleccionar procedimiento...</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="procedureTimes">
                                <i class="fas fa-redo" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                N√∫mero de Veces:
                            </label>
                            <input type="number"
                                   id="procedureTimes"
                                   min="1"
                                   required>
                        </div>
                        <div class="form-group">
                            <label for="procedureFrequency">
                                <i class="fas fa-clock" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                Frecuencia:
                            </label>
                            <input type="text"
                                   id="procedureFrequency"
                                   placeholder="ej: diaria, semanal"
                                   required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="procedureSpecialist">
                            <i class="fas fa-user-nurse" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Requiere Especialista:
                        </label>
                        <select id="procedureSpecialist" required>
                            <option value="false">No</option>
                            <option value="true">S√≠</option>
                        </select>
                    </div>

                    <div class="form-group" id="specialtyGroup" style="display: none;">
                        <label for="procedureSpecialty">
                            <i class="fas fa-graduation-cap" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Tipo de Especialidad:
                        </label>
                        <select id="procedureSpecialty">
                            <option value="">Seleccionar especialidad...</option>
                        </select>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-plus"></i>
                            ‚ûï Agregar a Orden
                        </button>
                        <button type="button" class="btn-success" onclick="createProcedureOrder()" style="margin-left: 1rem;">
                            <i class="fas fa-save"></i>
                            üíæ Crear Orden Completa
                        </button>
                    </div>
                </form>
            </div>

            <div class="list-section">
                <h3><i class="fas fa-list"></i> √ìrdenes de Procedimientos</h3>
                <div id="procedureOrdersList"></div>
            </div>
        </div>

        <div id="diagnostic-aids" class="tabcontent">
            <h2><i class="fas fa-flask" style="margin-right: 0.5rem; color: var(--primary-color);"></i>üß™ Ayudas Diagn√≥sticas</h2>
            <div class="search-container">
                <input type="text"
                       id="aidPatientSearch"
                       placeholder="Buscar paciente por c√©dula..."
                       style="flex: 1; min-width: 250px;">
                <button class="btn-secondary" onclick="searchPatientForAids()">
                    <i class="fas fa-search"></i>
                    Buscar
                </button>
            </div>
            <div id="aidPatientInfo" class="patient-info" style="display: none;"></div>

            <button class="accordion">
                <i class="fas fa-vial"></i>
                Crear Orden de Ayudas Diagn√≥sticas
            </button>
            <div class="panel">
                <form id="createAidOrderForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="aidOrderPatientCedula">
                                <i class="fas fa-id-card" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                C√©dula del Paciente:
                            </label>
                            <input type="text"
                                   id="aidOrderPatientCedula"
                                   required
                                   readonly>
                        </div>
                        <div class="form-group">
                            <label for="aidOrderNumber">
                                <i class="fas fa-hashtag" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                N√∫mero de Orden (6 d√≠gitos):
                            </label>
                            <input type="text"
                                   id="aidOrderNumber"
                                   pattern="[0-9]{6}"
                                   title="Debe ser un n√∫mero de 6 d√≠gitos"
                                   required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="aidSelect">
                            <i class="fas fa-flask" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Ayuda Diagn√≥stica:
                        </label>
                        <select id="aidSelect" required>
                            <option value="">Seleccionar ayuda diagn√≥stica...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="aidQuantity">
                            <i class="fas fa-hashtag" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Cantidad:
                        </label>
                        <input type="number"
                               id="aidQuantity"
                               min="1"
                               required>
                    </div>

                    <div class="form-group">
                        <label for="aidSpecialist">
                            <i class="fas fa-user-nurse" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Requiere Especialista:
                        </label>
                        <select id="aidSpecialist" required>
                            <option value="false">No</option>
                            <option value="true">S√≠</option>
                        </select>
                    </div>

                    <div class="form-group" id="aidSpecialtyGroup" style="display: none;">
                        <label for="aidSpecialty">
                            <i class="fas fa-graduation-cap" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Tipo de Especialidad:
                        </label>
                        <select id="aidSpecialty">
                            <option value="">Seleccionar especialidad...</option>
                        </select>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-plus"></i>
                            ‚ûï Agregar a Orden
                        </button>
                        <button type="button" class="btn-success" onclick="createAidOrder()" style="margin-left: 1rem;">
                            <i class="fas fa-save"></i>
                            üíæ Crear Orden Completa
                        </button>
                    </div>
                </form>
            </div>

            <div class="list-section">
                <h3><i class="fas fa-list"></i> √ìrdenes de Ayudas Diagn√≥sticas</h3>
                <div id="aidOrdersList"></div>
            </div>
        </div>

        <div id="hospitalization" class="tabcontent">
            <h2><i class="fas fa-bed" style="margin-right: 0.5rem; color: var(--primary-color);"></i>üè• Hospitalizaci√≥n</h2>
            <div class="search-container">
                <input type="text"
                       id="hospPatientSearch"
                       placeholder="Buscar paciente por c√©dula..."
                       style="flex: 1; min-width: 250px;">
                <button class="btn-secondary" onclick="searchPatientForHospitalization()">
                    <i class="fas fa-search"></i>
                    Buscar
                </button>
            </div>
            <div id="hospPatientInfo" class="patient-info" style="display: none;"></div>

            <button class="accordion">
                <i class="fas fa-bed"></i>
                Registrar Hospitalizaci√≥n
            </button>
            <div class="panel">
                <form id="createHospitalizationForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="hospPatientCedula">
                                <i class="fas fa-id-card" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                C√©dula del Paciente:
                            </label>
                            <input type="text"
                                   id="hospPatientCedula"
                                   required
                                   readonly>
                        </div>
                        <div class="form-group">
                            <label for="hospOrderNumber">
                                <i class="fas fa-hashtag" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                N√∫mero de Orden (6 d√≠gitos):
                            </label>
                            <input type="text"
                                   id="hospOrderNumber"
                                   pattern="[0-9]{6}"
                                   title="Debe ser un n√∫mero de 6 d√≠gitos"
                                   required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="admissionDate">
                                <i class="fas fa-calendar-plus" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                Fecha de Ingreso:
                            </label>
                            <input type="datetime-local"
                                   id="admissionDate"
                                   required>
                        </div>
                        <div class="form-group">
                            <label for="dischargeDate">
                                <i class="fas fa-calendar-minus" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                                Fecha de Alta (estimada):
                            </label>
                            <input type="datetime-local"
                                   id="dischargeDate">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="hospitalizationReason">
                            <i class="fas fa-info-circle" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Motivo de Hospitalizaci√≥n:
                        </label>
                        <textarea id="hospitalizationReason"
                                  placeholder="Describa el motivo de la hospitalizaci√≥n..."
                                  rows="4"
                                  required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="hospitalizationType">
                            <i class="fas fa-bed" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Tipo de Hospitalizaci√≥n:
                        </label>
                        <select id="hospitalizationType" required>
                            <option value="">Seleccionar tipo...</option>
                            <option value="observation">Observaci√≥n</option>
                            <option value="surgery">Cirug√≠a</option>
                            <option value="intensive_care">Cuidados Intensivos</option>
                            <option value="emergency">Emergencia</option>
                            <option value="maternity">Maternidad</option>
                            <option value="other">Otro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="roomNumber">
                            <i class="fas fa-door-closed" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            N√∫mero de Habitaci√≥n:
                        </label>
                        <input type="text"
                               id="roomNumber"
                               placeholder="ej: 201, UCI-1">
                    </div>

                    <div class="form-group">
                        <label for="responsibleNurse">
                            <i class="fas fa-user-nurse" style="margin-right: 0.5rem; color: var(--primary-color);"></i>
                            Enfermera Responsable:
                        </label>
                        <input type="text"
                               id="responsibleNurse"
                               placeholder="Nombre de la enfermera responsable">
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-bed"></i>
                            üè• Registrar Hospitalizaci√≥n
                        </button>
                        <button type="button" class="btn-warning" onclick="updateHospitalization()" style="margin-left: 1rem;">
                            <i class="fas fa-edit"></i>
                            üìù Actualizar Estado
                        </button>
                    </div>
                </form>
            </div>

            <div class="list-section">
                <h3><i class="fas fa-list"></i> Hospitalizaciones Activas</h3>
                <div id="hospitalizationList"></div>
            </div>
        </div>
    </div>
    <script src="config.js"></script>
    <script src="api.js"></script>
    <script src="doctor.js"></script>
</body>
</html>